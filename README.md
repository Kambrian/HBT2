new implementation of HBT in C++ 
